{% extends "_base.html" %}
{% block title %}
 Sractch Ticket
{% endblock %}
{% block body %}
<div class="box">
  <image class="images" src="../static/scratch.jpg">
    <canvas id="canvas"></canvas>
    {% for i in index %}
    <image class="numbers" style="top:{{ypos[i]}};right:{{xpos[i]}};" src="../static/{{numbers[i]}}">
    {% endfor %}
</div>
  <div class="card" id="rules" style="width: 18rem;">
    <div class="card-body">
      <h5 class="card-title">Rules to Win!</h5>
      <p class="card-text">In order to win a prize, scratch the card. For each row, if the three numbers form a sequence
      (from left to right) that is a strictly increasing (1,1,2 for example doesn't count) sequence, you will win $10,000.
      If any row has three of the same numbers, you will get $100,000. Get Scratching!</p>
      <a href="#" class="btn btn-primary">Claim Prize!</a>
    </div>
  </div>
<script type="text/javascript">
var url = '../static/lotto.jpg';
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
var img = new Image();
img.src = url;
img.onload = function () {
  var width = Math.min(500, img.width);
  var height = img.height * (width / img.width);

  canvas.width = width;
  canvas.height = height;
  ctx.drawImage(img, 0, 0, width, height);
};

var isPress = false;
var old = null;
canvas.addEventListener('mousedown', function (e){
  isPress = true;
  old = {x: e.offsetX, y: e.offsetY};
});
canvas.addEventListener('mousemove', function (e){
  if (isPress) {
    var x = e.offsetX;
    var y = e.offsetY;
    ctx.globalCompositeOperation = 'destination-out';

    ctx.beginPath();
    ctx.arc(x, y, 10, 0, 2 * Math.PI);
    ctx.fill();

    ctx.lineWidth = 20;
    ctx.beginPath();
    ctx.moveTo(old.x, old.y);
    ctx.lineTo(x, y);
    ctx.stroke();

    old = {x: x, y: y};

  }
});
canvas.addEventListener('mouseup', function (e){
  isPress = false;
});
</script>
{% endblock %}
